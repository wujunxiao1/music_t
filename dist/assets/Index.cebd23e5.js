import{ah as P,ai as j,n as B,aj as R,t as D,ak as U,U as z,M as K,a5 as G,a6 as Y,K as J,r as m,o as Q,w as V,h as p,j as h,G as $,H as A,B as x,k as _,$ as W,I as C,x as O,a as X,q as Z,z as ee,l as te,a8 as se}from"./index.d80bb040.js";import{P as ne}from"./PlayList.7bd27289.js";import"./el-skeleton-item.d9bf27c5.js";const f="ElInfiniteScroll",ae=50,le=200,oe=0,ie={delay:{type:Number,default:le},distance:{type:Number,default:oe},disabled:{type:Boolean,default:!1},immediate:{type:Boolean,default:!0}},H=(e,t)=>Object.entries(ie).reduce((n,[s,r])=>{var i,c;const{type:u,default:d}=r,l=e.getAttribute(`infinite-scroll-${s}`);let a=(c=(i=t[l])!=null?i:l)!=null?c:d;return a=a==="false"?!1:a,a=u(a),n[s]=Number.isNaN(a)?d:a,n},{}),F=e=>{const{observer:t}=e[f];t&&(t.disconnect(),delete e[f].observer)},ce=(e,t)=>{const{container:n,containerEl:s,instance:r,observer:i,lastScrollTop:c}=e[f],{disabled:u,distance:d}=H(e,r),{clientHeight:l,scrollHeight:a,scrollTop:y}=s,E=y-c;if(e[f].lastScrollTop=y,i||u||E<0)return;let g=!1;if(n===e)g=a-(l+y)<=d;else{const{clientTop:T,scrollHeight:I}=e,L=U(e,s);g=y+l>=L+T+I-d}g&&t.call(r)};function w(e,t){const{containerEl:n,instance:s}=e[f],{disabled:r}=H(e,s);r||n.clientHeight===0||(n.scrollHeight<=n.clientHeight?t.call(s):F(e))}const re={async mounted(e,t){const{instance:n,value:s}=t;P(s)||j(f,"'v-infinite-scroll' binding value must be a function"),await B();const{delay:r,immediate:i}=H(e,n),c=R(e,!0),u=c===window?document.documentElement:c,d=D(ce.bind(null,e,s),r);if(!!c){if(e[f]={instance:n,container:c,containerEl:u,delay:r,cb:s,onScroll:d,lastScrollTop:u.scrollTop},i){const l=new MutationObserver(D(w.bind(null,e,s),ae));e[f].observer=l,l.observe(e,{childList:!0,subtree:!0}),w(e,s)}c.addEventListener("scroll",d)}},unmounted(e){const{container:t,onScroll:n}=e[f];t==null||t.removeEventListener("scroll",n),F(e)},async updated(e){e[f]||await B();const{containerEl:t,cb:n,observer:s}=e[f];t.clientHeight&&s&&w(e,n)}},N=re;N.install=e=>{e.directive("InfiniteScroll",N)};const ue=N;const de={class:"playlist"},ve={key:0,class:"filter card"},fe={class:"filter-title"},pe={class:"filter-box"},_e=["onClick"],he={class:"list-container"},ye={class:"list-main"},me={class:"list-head"},ge={key:0,class:"filter-close"},be={class:"type"},Ee=["infinite-scroll-disabled"],Te={setup(e){const{proxy:t}=K(),n=G(),s=Y(),r=n.query.cat,i=J({order:"hot",cat:r,limit:48,offset:0}),c=m([]),u=m("\u5168\u90E8\u6B4C\u5355"),d="\u5168\u90E8\u6B4C\u5355",l=m(!0),a=m([]),y=m(24),E=m(!0),g=async()=>{const{data:o}=await t.$http.catlist();if(o.code!==200)return t.$msg.error("\u6570\u636E\u8BF7\u6C42\u5931\u8D25");for(let v in o.categories)c.value.push({name:o.categories[v],children:o.sub.filter(b=>b.category==v)});u.value=r||o.all.name},T=async o=>{const{data:v}=await t.$http.playList(o);if(v.code!==200)return t.$msg.error("\u6570\u636E\u8BF7\u6C42\u5931\u8D25");a.value=o.offset!==0?[...a.value,...v.playlists]:v.playlists,l.value=a.value.length>=v.total,E.value=!1},I=o=>{a.value=[],l.value=!0,s.push({path:"playlist",query:{cat:o.name,order:i.order}})},L=()=>{a.value=[],l.value=!0,s.push({path:"playlist"})},q=()=>{l.value=!0,i.offset=a.value.length};return Q(()=>{g(),T(i)}),V(()=>n.query,(o,v)=>{const{cat:b,order:S}=o;u.value=b||d,i.cat=u.value,i.order=S||"hot"}),V(()=>i,(o,v)=>{o.cat!==v.cat&&(l.value=!0,a.value=[]),T(o),console.log(3333)},{deep:!0}),(o,v)=>{const b=ue;return p(),h("div",de,[c.value.length?(p(),h("div",ve,[(p(!0),h($,null,A(c.value,(S,M)=>(p(),h("div",{class:"filter-item",key:M},[_("div",fe,C(S.name),1),_("div",pe,[(p(!0),h($,null,A(S.children,k=>(p(),h("span",{class:O(["item-box",u.value===k.name?"active":""]),key:k.name,onClick:Se=>I(k)},C(k.name),11,_e))),128))])]))),128))])):x("",!0),_("div",he,[_("div",ye,[_("div",me,[_("h2",null,[W(C(u.value)+" ",1),u.value!==d?(p(),h("em",ge,[_("i",{class:"iconfont icon-closed",onClick:L})])):x("",!0)]),_("div",be,[_("span",{class:O(X(i).order==="hot"?"active":"")},"\u70ED\u95E8",2)])]),Z((p(),h("div",{class:"wrapper infinite-list","infinite-scroll-disabled":l.value,"infinite-scroll-distance":100},[ee(ne,{playList:a.value,loading:E.value,num:y.value},null,8,["playList","loading","num"]),l.value?(p(),te(se,{key:0})):x("",!0)],8,Ee)),[[b,q]])])])])}}};var xe=z(Te,[["__scopeId","data-v-04f042d8"]]);export{xe as default};
